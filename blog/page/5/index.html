
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Yankist</title>
	<meta name="author" content="Ken Lu, Andrew Sheelan Paliyan">

	
	<meta name="description" content="Learning Regular expressions require regular practice. Here are a few ways to practice: rails c
Rubular Any questions on this, please feel free to &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Yankist" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Yankist</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:Andrew-Ken.github.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/admin@yankist.com?rel=author" title="Google+">Google+</a>
		
		
		
		<a class="github" href="https://github.com/Andrew-Ken" title="GitHub">GitHub</a>
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:Andrew-Ken.github.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/11/12/learning-regular-expressions/">
		
			Learning Regular Expressions</a>
	</h2>
	<div class="entry-content">
		<p>Learning Regular expressions require regular practice. Here are a few ways to practice:</p>

<ol>
<li>rails c</li>
<li><a href="http://rubular.com/">Rubular</a></li>
</ol>


<p>Any questions on this, please feel free to ask. We&#8217;re here to help&#8230;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-12T15:54:00-05:00" pubdate data-updated="true">Nov 12<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/regular-expressions/'>regular expressions</a>


</div>
	
		<span class="comments"><a href="/blog/2012/11/12/learning-regular-expressions//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/11/12/how-to-use-observer-and-call-back/">
		
			How to Use Observer and Call Back</a>
	</h2>
	<div class="entry-content">
		<ul>
<li>Add configuration</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#config/application.rb</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">active_record</span><span class="o">.</span><span class="n">observers</span> <span class="o">=</span> <span class="ss">:order_observer</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Create a Observer Class</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">OrderObserver</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Observer</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">after_update</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span><span class='line'>    <span class="n">order</span><span class="o">.</span><span class="n">update_column</span><span class="p">(</span><span class="s1">&#39;type_state&#39;</span><span class="p">,</span> <span class="s2">&quot;UPDATED&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>or we can use the way to register</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#config/application.rb</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">active_record</span><span class="o">.</span><span class="n">observers</span> <span class="o">=</span> <span class="ss">:notification_observer</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">NotificationObserver</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Observer</span>
</span><span class='line'>  <span class="n">observe</span> <span class="ss">:account</span><span class="p">,</span> <span class="ss">:balance</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">after_update</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span><span class='line'>    <span class="n">order</span><span class="o">.</span><span class="n">update_column</span><span class="p">(</span><span class="s1">&#39;type_state&#39;</span><span class="p">,</span> <span class="s2">&quot;UPDATED&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Any questions on this, please feel free to ask. We&#8217;re here to help&#8230;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-12T15:07:00-05:00" pubdate data-updated="true">Nov 12<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails3/'>rails3</a>


</div>
	
		<span class="comments"><a href="/blog/2012/11/12/how-to-use-observer-and-call-back//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/11/09/how-to-proxy-a-domain-as-local/">
		
			How to Proxy a Domain to Localhost</a>
	</h2>
	<div class="entry-content">
		<ul>
<li>STEP 1:</li>
</ul>


<p>Edit your hosts file by typing:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo vim /etc/hosts
</span></code></pre></td></tr></table></div></figure>


<p>Add the following line to the file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>127.0.0.1 google.com <span class="o">(</span>or whatever other hostname you want proxied<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>STEP 2:</li>
</ul>


<p>Type the following into the command line to (ip foward)set up the server port to 80 in this case it is 3000:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo ipfw add 100 fwd 127.0.0.1,3000 tcp from any to any 80 in
</span></code></pre></td></tr></table></div></figure>


<p>Any questions on this, please feel free to ask. We&#8217;re here to help&#8230;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-09T14:29:00-05:00" pubdate data-updated="true">Nov 9<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/bash/'>bash</a>, <a class='category' href='/blog/categories/ipfw/'>ipfw</a>, <a class='category' href='/blog/categories/mac/'>mac</a>


</div>
	
		<span class="comments"><a href="/blog/2012/11/09/how-to-proxy-a-domain-as-local//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/08/04/some-ruby-on-rails-interview-questions/">
		
			Some Ruby on Rails Interview Questions</a>
	</h2>
	<div class="entry-content">
		<p><strong>what&#8217;s N+1 problem, how to solve the problem</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">clients</span> <span class="o">=</span> <span class="no">Client</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">clients</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">client</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">client</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">postcode</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">clients</span> <span class="o">=</span> <span class="no">Client</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="ss">:address</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">clients</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">client</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">client</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">postcode</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>what&#8217;s the different with joins and includes</strong></p>

<p><strong>explain eager loading and lazy loading</strong></p>

<p><strong>how to get the top 10 average rating product name:</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Product</span><span class="p">:</span> <span class="nb">name</span><span class="ss">:string</span><span class="p">,</span> <span class="nb">id</span><span class="ss">:integer</span><span class="p">,</span>
</span><span class='line'><span class="no">Review</span><span class="p">:</span> <span class="nb">id</span><span class="ss">:integer</span><span class="p">,</span> <span class="n">rating</span><span class="ss">:integer</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="n">integer</span>
</span><span class='line'><span class="c1">#solution</span>
</span><span class='line'><span class="nb">select</span> <span class="nb">p</span><span class="o">.</span><span class="n">name</span> <span class="n">from</span> <span class="n">products</span> <span class="n">as</span> <span class="nb">p</span> <span class="n">inner</span> <span class="n">join</span> <span class="n">review</span> <span class="n">as</span> <span class="n">r</span> <span class="n">group</span> <span class="n">by</span> <span class="n">r</span><span class="o">.</span><span class="n">prouct_id</span> <span class="n">order</span> <span class="n">avg</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">rating</span><span class="p">)</span> <span class="n">limit</span> <span class="mi">10</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>using map and reduce to sum up 5 to 26 which is squareable</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">SQ</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">square</span> <span class="n">num</span>
</span><span class='line'>    <span class="n">num</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="k">return</span> <span class="kp">true</span> <span class="k">if</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="mi">5</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">){</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span><span class="n">x</span><span class="o">|</span><span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">x</span> <span class="k">if</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="n">sum</span> <span class="p">}</span>
</span><span class='line'><span class="mi">5</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">){</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span><span class="n">x</span><span class="o">|</span><span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">?</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>dynamic load</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">A</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">check_credit</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;A&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">B</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">check_credit</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;B&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">P</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:type</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">process</span>
</span><span class='line'>    <span class="c1">#class_eval</span>
</span><span class='line'>    <span class="c1">#self &lt;&lt; class</span>
</span><span class='line'>      <span class="c1">#include eval(type)</span>
</span><span class='line'>    <span class="c1">#end</span>
</span><span class='line'>    <span class="n">type</span><span class="o">.</span><span class="n">constantize</span><span class="o">.</span><span class="n">check_credit</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">check_credit</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-08-04T18:22:00-04:00" pubdate data-updated="true">Aug 4<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/interview/'>interview</a>, <a class='category' href='/blog/categories/questions/'>questions</a>, <a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/rails3/'>rails3</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
		<span class="comments"><a href="/blog/2012/08/04/some-ruby-on-rails-interview-questions//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/04/20/octopress-no-lexer-error/">
		
			Octopress No Lexer Error</a>
	</h2>
	<div class="entry-content">
		<p>just got error</p>

<blockquote><p>/Users/ken/.rvm/gems/ruby-1.9.3-p327/gems/rubypython-0.5.3/lib/rubypython/rubypyproxy.rb:198:in `method_missing&#8217;: ClassNotFound: no lexer for alias &#8216;Ruby&#8217; found (RubyPython::PythonError)</p></blockquote>

<p>the problem is I put <code>Ruby</code> as syntax, It should be just <code>ruby</code></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-04-20T08:31:00-04:00" pubdate data-updated="true">Apr 20<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/octopress/'>octopress</a>, <a class='category' href='/blog/categories/syntax/'>syntax</a>


</div>
	
		<span class="comments"><a href="/blog/2012/04/20/octopress-no-lexer-error//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2011/12/26/retry-and-retry-code-blocks/">
		
			Retry and Retry Code Blocks</a>
	</h2>
	<div class="entry-content">
		<h2>simple way to rescue and retry several</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">begin</span>
</span><span class='line'>  <span class="c1"># some routine</span>
</span><span class='line'><span class="k">rescue</span>
</span><span class='line'>  <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">retry</span> <span class="k">if</span> <span class="n">tries</span> <span class="o">&lt;=</span> <span class="mi">3</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;no dice!&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="c1">#or</span>
</span><span class='line'><span class="mi">3</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">begin</span>
</span><span class='line'>    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>  <span class="k">rescue</span>
</span><span class='line'>    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">break</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>with_rescue</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Integer</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">times_try</span>
</span><span class='line'>    <span class="n">n</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">yield</span>
</span><span class='line'>    <span class="k">rescue</span>
</span><span class='line'>      <span class="k">raise</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span><span class='line'>      <span class="k">retry</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">begin</span>
</span><span class='line'>  <span class="mi">3</span><span class="o">.</span><span class="n">times_try</span> <span class="k">do</span>
</span><span class='line'>    <span class="c1">#some routine</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">rescue</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s1">&#39;no dice!&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>if you don&#8217;t want to define</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">begin</span>
</span><span class='line'>  <span class="c1">#your code</span>
</span><span class='line'><span class="k">rescue</span>
</span><span class='line'>  <span class="k">retry</span> <span class="k">if</span> <span class="n">_r</span> <span class="o">=</span> <span class="p">(</span><span class="n">_r</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">_r</span> <span class="o">&lt;</span> <span class="mi">4</span>
</span><span class='line'>  <span class="k">raise</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">with_rescue</span><span class="p">(</span><span class="no">ProtocolError</span><span class="p">,</span> <span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">try</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">try</span> <span class="o">==</span> <span class="mi">0</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;HTTP/1.1&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Retry Block Code</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Options:</span>
</span><span class='line'><span class="c1"># * :tries - Number of retries to perform. Defaults to 1.</span>
</span><span class='line'><span class="c1"># * :on - The Exception on which a retry will be performed. Defaults to Exception, which retries on any Exception.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Example</span>
</span><span class='line'><span class="c1"># =======</span>
</span><span class='line'><span class="c1">#   retryable(:tries =&gt; 1, :on =&gt; OpenURI::HTTPError) do</span>
</span><span class='line'><span class="c1">#     # your code here</span>
</span><span class='line'><span class="c1">#   end</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">def</span> <span class="nf">retryable</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>  <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:tries</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="no">Exception</span> <span class="p">}</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">retry_exception</span><span class="p">,</span> <span class="n">retries</span> <span class="o">=</span> <span class="n">opts</span><span class="o">[</span><span class="ss">:on</span><span class="o">]</span><span class="p">,</span> <span class="n">opts</span><span class="o">[</span><span class="ss">:tries</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">begin</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">yield</span>
</span><span class='line'>  <span class="k">rescue</span> <span class="n">retry_exception</span>
</span><span class='line'>    <span class="k">retry</span> <span class="k">if</span> <span class="p">(</span><span class="n">retries</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">yield</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>us it as</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">retryable</span><span class="p">(</span><span class="ss">:tries</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="no">OpenURI</span><span class="o">::</span><span class="no">HTTPError</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;http://example.com/flaky_api&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="c1"># Code that mashes up stuff for your &quot;social networking&quot; site.</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here are the <tt><a href="http://pastie.caboo.se/138570">Kernel#retryable specs (pastie)</a></tt><a href="http://blog.codefront.net/2008/01/14/retrying-code-blocks-in-ruby-on-exceptions-whatever/">.</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-12-26T06:20:00-05:00" pubdate data-updated="true">Dec 26<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/block/'>block</a>, <a class='category' href='/blog/categories/rescue/'>rescue</a>, <a class='category' href='/blog/categories/retry/'>retry</a>


</div>
	
		<span class="comments"><a href="/blog/2011/12/26/retry-and-retry-code-blocks//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2011/11/06/webkit-and-rspec-without-x-server/">
		
			Webkit and Rspec Without X Server</a>
	</h2>
	<div class="entry-content">
		<h2>capybara-webkit</h2>

<p>problems running capybara-webkit with the Headless gem, Xvfb and our ci server. We use this setup for automatic integration testing and javascript testing of our Ruby on Rails 3.2 app. During the tests it complains that</p>

<blockquote><p>webkit_server: cannot connect to X server
need to rspec to config as:</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">&quot;../../config/environment&quot;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rspec/rails&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rspec/autorun&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/rspec&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/webkit&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;headless&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">register_driver</span> <span class="ss">:webkit</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
</span><span class='line'>  <span class="no">Capybara</span><span class="o">::</span><span class="no">Driver</span><span class="o">::</span><span class="no">Webkit</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="ss">:ignore_ssl_errors</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">javascript_driver</span> <span class="o">=</span> <span class="ss">:webkit</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># don&#39;t run on the local machine (since we don&#39;t have xvfb running locally)</span>
</span><span class='line'><span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">production?</span>
</span><span class='line'>    <span class="n">headless</span> <span class="o">=</span> <span class="no">Headless</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">headless</span><span class="o">.</span><span class="n">start</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-11-06T07:05:00-05:00" pubdate data-updated="true">Nov 6<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/capybara-webkit/'>capybara-webkit</a>, <a class='category' href='/blog/categories/headless/'>headless</a>, <a class='category' href='/blog/categories/rspec/'>rspec</a>, <a class='category' href='/blog/categories/xserver/'>xserver</a>, <a class='category' href='/blog/categories/xvfb/'>xvfb</a>


</div>
	
		<span class="comments"><a href="/blog/2011/11/06/webkit-and-rspec-without-x-server//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2011/10/26/ruby-selenium-webdriver-watir-webdriver/">
		
			Ruby Selenium-webdriver Watir-webdriver</a>
	</h2>
	<div class="entry-content">
		<p>There are many other Selenium gems out there, but this is the only official, maintained gem. If you&#8217;re looking for a slightly higher level API built on the same technology, you may want to check out <a href="http://watirwebdriver.com/">watir-webdriver</a> or <a href="https://github.com/jnicklas/capybara">capybara</a>.</p>

<h2>example code</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s2">&quot;selenium-webdriver&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:firefox</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">navigate</span><span class="o">.</span><span class="n">to</span> <span class="s2">&quot;http://google.com&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">send_keys</span> <span class="s2">&quot;Hello WebDriver!&quot;</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">submit</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
</span><span class='line'>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">quit</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># execute arbitrary javascript</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return window.location.pathname&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># pass elements between Ruby and JavaScript</span>
</span><span class='line'><span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return document.body&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return arguments[0].tagName&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="c1">#=&gt; &quot;BODY&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># wait for a specific element to show up</span>
</span><span class='line'><span class="n">wait</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Wait</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:timeout</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># seconds</span>
</span><span class='line'><span class="n">wait</span><span class="o">.</span><span class="n">until</span> <span class="p">{</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># switch to a frame</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span> <span class="s2">&quot;some-frame&quot;</span> <span class="c1"># name or id</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="ss">:id</span><span class="p">,</span> <span class="s1">&#39;some-frame&#39;</span><span class="p">)</span> <span class="c1"># frame element</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># switch back to the main document</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># repositionning and resizing browser window:</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">resize_to</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
</span><span class='line'><span class="n">driver</span><span class="o">.</span><span class="n">manage</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">maximize</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get an attribute</span>
</span><span class='line'><span class="n">class_name</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># is the element visible on the page?</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">displayed?</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># click the element</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get the element location</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">location</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># scroll the element into view, then return its location</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">location_once_scrolled_into_view</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get the width and height of an element</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># press space on an element - see Selenium::WebDriver::Keys for possible values</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">send_keys</span> <span class="ss">:space</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get the text of an element</span>
</span><span class='line'><span class="n">element</span><span class="o">.</span><span class="n">text</span>
</span></code></pre></td></tr></table></div></figure>


<h2>SSL Certificates</h2>

<p>The Firefox driver ignores invalid SSL certificates by default. If this is not the behaviour you want, you can do:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">profile</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Firefox</span><span class="o">::</span><span class="no">Profile</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">profile</span><span class="o">.</span><span class="n">secure_ssl</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'><span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:firefox</span><span class="p">,</span> <span class="ss">:profile</span> <span class="o">=&gt;</span> <span class="n">profile</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is an edge case where the default SSL certificate check will not work correctly. WebDriver assumes that the certificate is untrusted whenever there&#8217;s a problem, which means a certificate from a trusted issuer but with a hostname mismatch (e.g. a production certificate in a test environment) will not be correctly ovverriden. See UntrustedSSLCertificates for more on why this is. To work around it, tell the Firefox driver to not assume the issuer is untrusted:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">profile</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Firefox</span><span class="o">::</span><span class="no">Profile</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">profile</span><span class="o">.</span><span class="n">assume_untrusted_certificate_issuer</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'><span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">.</span><span class="n">for</span> <span class="ss">:firefox</span><span class="p">,</span> <span class="ss">:profile</span> <span class="o">=&gt;</span> <span class="n">profile</span>
</span></code></pre></td></tr></table></div></figure>


<p>Not that Profile#secure_ssl remains set to the default value of true in the above example<a href="http://code.google.com/p/selenium/wiki/RubyBindings">.</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-26T08:12:00-04:00" pubdate data-updated="true">Oct 26<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rspec/'>rspec</a>, <a class='category' href='/blog/categories/selenium-webdriver/'>selenium-webdriver</a>


</div>
	
		<span class="comments"><a href="/blog/2011/10/26/ruby-selenium-webdriver-watir-webdriver//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2011/02/02/create-ruby-dynamic-class/">
		
			Create Ruby Dynamic Class</a>
	</h2>
	<div class="entry-content">
		<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">dynamic_name</span> <span class="o">=</span> <span class="s2">&quot;TestEval2&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Object</span><span class="o">.</span><span class="n">const_set</span><span class="p">(</span><span class="n">dynamic_name</span><span class="p">,</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
</span><span class='line'><span class="n">dummy2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">dynamic_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;dummy2: </span><span class="si">#{</span><span class="n">dummy2</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">dynamic_name</span> <span class="o">=</span> <span class="s2">&quot;ClassName&quot;</span>
</span><span class='line'><span class="no">Object</span><span class="o">.</span><span class="n">const_set</span><span class="p">(</span><span class="n">dynamic_name</span><span class="p">,</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="k">def</span> <span class="nf">method1</span><span class="p">()</span> <span class="mi">42</span> <span class="k">end</span> <span class="p">})</span>
</span><span class='line'><span class="no">ClassName</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">method1</span> <span class="c1">#=&gt; 42</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">class_name</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="o">.</span><span class="n">capitalize</span>
</span><span class='line'><span class="n">klass</span> <span class="o">=</span> <span class="no">Object</span><span class="o">.</span><span class="n">const_set</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span><span class="no">Class</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;instance1&#39;</span><span class="p">,</span> <span class="s1">&#39;instance2&#39;</span><span class="o">]</span> <span class="c1"># Array of instance vars</span>
</span><span class='line'>
</span><span class='line'><span class="n">klass</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="o">*</span><span class="n">names</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">define_method</span><span class="p">(</span><span class="ss">:initialize</span><span class="p">)</span> <span class="k">do</span> <span class="o">|*</span><span class="n">values</span><span class="o">|</span>
</span><span class='line'>    <span class="n">names</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">instance_variable_set</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="o">+</span><span class="nb">name</span><span class="p">,</span> <span class="n">values</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># more...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>class_eval and const_set are used.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">a_new_class</span> <span class="o">=</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">Object</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:x</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">print</span> <span class="c1">#{self.class} initialized with #{x}&quot;</span>
</span><span class='line'>    <span class="vi">@x</span> <span class="o">=</span> <span class="n">x</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">SomeModule</span><span class="o">.</span><span class="n">const_set</span><span class="p">(</span><span class="s2">&quot;ClassName&quot;</span><span class="p">,</span> <span class="n">a_new_class</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">c</span> <span class="o">=</span> <span class="no">ClassName</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>without class_eval and const_set
You don&#8217;t really need to use const_set. The return value of Class.new can be assigned to a constant and the block of Class.new is class_eval.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">ass</span> <span class="no">Ancestor</span><span class="p">;</span> <span class="k">end</span>
</span><span class='line'><span class="no">SomeClass</span> <span class="o">=</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">Ancestor</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</span><span class='line'>     <span class="nb">print</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="si">}</span><span class="s2"> initialized with </span><span class="si">#{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="no">SomeClass</span>
</span><span class='line'><span class="no">SomeClass</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1"># SomeClass initialized with foo=&gt; #&lt;SomeClass:0x668b68&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The following code uses a class factory to create a new class along with getter and setters for the fields passed into it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ClassFactory</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">create_class</span><span class="p">(</span><span class="n">new_class</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span>
</span><span class='line'>    <span class="n">c</span> <span class="o">=</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">fields</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">field</span><span class="o">|</span>
</span><span class='line'>        <span class="n">define_method</span> <span class="n">field</span><span class="o">.</span><span class="n">intern</span> <span class="k">do</span>
</span><span class='line'>          <span class="nb">instance_variable_get</span><span class="p">(</span><span class="s2">&quot;@</span><span class="si">#{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>        <span class="n">define_method</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">field</span><span class="si">}</span><span class="s2">=&quot;</span><span class="o">.</span><span class="n">intern</span> <span class="k">do</span> <span class="o">|</span><span class="n">arg</span><span class="o">|</span>
</span><span class='line'>          <span class="nb">instance_variable_set</span><span class="p">(</span><span class="s2">&quot;@</span><span class="si">#{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="no">Kernel</span><span class="o">.</span><span class="n">const_set</span> <span class="n">new_class</span><span class="p">,</span> <span class="n">c</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">ClassFactory</span><span class="o">.</span><span class="n">create_class</span> <span class="s2">&quot;Car&quot;</span><span class="p">,</span> <span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">new_class</span> <span class="o">=</span> <span class="no">Car</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">new_class</span><span class="o">.</span><span class="n">make</span> <span class="o">=</span> <span class="s2">&quot;Nissan&quot;</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">new_class</span><span class="o">.</span><span class="n">make</span> <span class="c1"># =&gt; &quot;Nissan&quot;</span>
</span><span class='line'><span class="n">new_class</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;Maxima&quot;</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">new_class</span><span class="o">.</span><span class="n">model</span> <span class="c1"># =&gt; &quot;Maxima&quot;</span>
</span><span class='line'><span class="n">new_class</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="s2">&quot;2001&quot;</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">new_class</span><span class="o">.</span><span class="n">year</span> <span class="c1"># =&gt; &quot;2001&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In Ruby, classes are simply objects like any other, which are then assigned to a constant.  Hence, to create a new class dynamically we instantiate the class Class with Class.new, and then assign it to a constant via const_set (we invoke it on Kernel so that it is a top-level constant like any other class).  We then add the code that makes up the class in a do-end block.</p>

<p>In that do-end block, for each field we invoke define_method twice, first for the getter method and then the setter method with get_instance_variable and set_instance_variable, respectively.  For each field, we create the instance variables (e.g., for make, we use @make).  Note how we make use of passing the argument in for the setter.</p>

<p>Additionally, if I wanted to make the class a sub-class, I could have used Class.new(parent_class)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-02-02T18:24:00-05:00" pubdate data-updated="true">Feb 2<span>nd</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/class/'>class</a>, <a class='category' href='/blog/categories/dynamic/'>dynamic</a>, <a class='category' href='/blog/categories/metaprogramming/'>metaprogramming</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
		<span class="comments"><a href="/blog/2011/02/02/create-ruby-dynamic-class//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2010/07/20/basic-metaprogramming-ruby-class-eval-and-instance-eval/">
		
			Basic Metaprogramming Ruby Class_eval and Instance_eval</a>
	</h2>
	<div class="entry-content">
		<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">instance_eval</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">define_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">&quot;Nice!  I&#39;m </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="k">def</span> <span class="nf">human?</span>
</span><span class='line'>        <span class="kp">true</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_class_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">instance_eval</span> <span class="k">do</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">send</span><span class="p">(</span> <span class="ss">:define_method</span><span class="p">,</span> <span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">&quot;Nice!  I&#39;m </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_instance_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span><span class="p">;</span> <span class="nb">self</span><span class="p">;</span> <span class="k">end</span><span class="p">)</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>      <span class="c1">#self.class.send( :define_method, name) { puts &quot;Nice!  I&#39;m #{name}&quot; }</span>
</span><span class='line'>      <span class="n">define_method</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">&quot;Nice!  I&#39;m </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Sometimes when the book explains a concept or Ruby feature, it sheds light on things I&#8217;ve seen in other people&#8217;s code  things I&#8217;ve always wondered about. One such example is class_eval and instance_eval. These methods allow you to evaluate arbitrary code in the context of a particular class or object. They&#8217;re slightly similar to call, apply and bind in JavaScript, in that you are altering the value of self (this in JavaScript) when you use them. Let&#8217;s take a look at some examples to demonstrate their usage.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Person</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Person</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">say_hello</span>
</span><span class='line'>   <span class="s2">&quot;Hello!&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">jimmy</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">jimmy</span><span class="o">.</span><span class="n">say_hello</span> <span class="c1"># &quot;Hello!&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example, class_eval allows us to define a method within the Person class outside of its original definition and without reopening the class with the standard syntax. This could be useful when the class you want to add this method to is not known until runtime.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Person</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Person</span><span class="o">.</span><span class="n">instance_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">human?</span>
</span><span class='line'>    <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Person.human? # true
This example of instance_eval is similar, but evaluates the code in the context of an instance instead of a class. This is confusing at first, because in these examples class_eval creates instance methods and instance_eval creates class methods. There is reason behind the madness, however.</p>

<p>class_eval is a method of the Module class, meaning that the receiver will be a module or a class. The block you pass to class_eval is evaluated in the context of that class. Defining a method with the standard def keyword within a class defines an instance method, and that&#8217;s exactly what happens here.</p>

<p>instance_eval, on the other hand, is a method of the Object class, meaning that the receiver will be an object. The block you pass to instance_eval is evaluated in the context of that object. That means that Person.instance_eval is evaluated in the context of the Person object. Remember that a class name is simply a constant which points to an instance of the class Class. Because of this fact, defining a method in the context of Class instance referenced by Person creates a class method for Person class.</p>

<p>It may be difficult to wrap your mind around that if you&#8217;re not familiar with the Ruby object model, but it&#8217;s still easy to remember how these methods behave with a simple mnemonic device: when called on a class name constant, these two methods will allow you to create methods of the opposite type from their names. MyClass.class_eval will create instance methods and MyClass.instance_eval will create class methods.</p>

<p>If you&#8217;re interested in metaprogramming or understanding the Ruby object model, I&#8217;d definitely recommend the book. It&#8217;s helped me out tremendously.</p>

<p>I did some experiment with meta programming keywords &#8220;class_eval&#8221; and &#8220;instance_eval&#8217;. Sharing some of the examples with you all -</p>

<p>class_eval opens the existing class and adds the methods as defined in an ordinary class, hence they work as instance methods of that class</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">String</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">quack</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;quack method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&quot;any string&quot;</span><span class="o">.</span><span class="n">quack</span>
</span></code></pre></td></tr></table></div></figure>


<p>A method defined for class A using class_eval will work as instance method of A</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">some_method</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;some_method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">some_method</span>
</span></code></pre></td></tr></table></div></figure>


<p>instance_eval on a class will open the class as an instance of class Class. Any method defined will be treated as the method of this instance which is the class. Hence the methods work like class methods</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span><span class="o">.</span><span class="n">instance_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">other_method</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;other_method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span><span class="o">.</span><span class="n">other_method</span>
</span></code></pre></td></tr></table></div></figure>


<p>instance_eval on an instance of a class will open that instance of the class. Thus it works like a singleton method that is specific to the instance and wont work for other instances of the class</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">instance_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">a_method</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;a_method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">a_method</span>  <span class="c1"># works for &#39;a&#39; on which the instance_eval is defined</span>
</span><span class='line'><span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">b</span><span class="o">.</span><span class="n">a_method</span>  <span class="c1"># doesn&#39;t work for &#39;b&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p> This is the same as calling instance_eval on the instance &#8216;a&#8217; of class A. This again will define a singleton method on the instance</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="n">a</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;this is a method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">a</span>  <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">show</span>
</span><span class='line'><span class="n">b</span><span class="o">.</span><span class="n">show</span>  <span class="c1"># doesn&#39;t work for &#39;b&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>  Can not call &#8216;class_eval&#8217; on an instance. class_eval can only be called on classes (which are instances of class Class)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show_other</span>
</span><span class='line'>    <span class="nb">p</span> <span class="s1">&#39;this is another method&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">show</span>
</span><span class='line'><span class="n">b</span><span class="o">.</span><span class="n">show</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-07-20T19:21:00-04:00" pubdate data-updated="true">Jul 20<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/class-eval/'>class_eval</a>, <a class='category' href='/blog/categories/instance-eval/'>instance_eval</a>, <a class='category' href='/blog/categories/metaprogramming/'>metaprogramming</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
		<span class="comments"><a href="/blog/2010/07/20/basic-metaprogramming-ruby-class-eval-and-instance-eval//blog/page/5/index.html#disqus_thread">Comments</a></span>
        <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#EEEEEE' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0xEEEEEE&amp;tcolor2=0x666666&amp;hicolor=0x268BD2&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Falgorithm%27+style%3D%27font-size%3A+14.0%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass%27+style%3D%27font-size%3A+12.0%25%27%3Eclass%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fclass-eval%27+style%3D%27font-size%3A+12.0%25%27%3Eclass_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fcmd%27+style%3D%27font-size%3A+12.0%25%27%3Ecmd%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fdynamic%27+style%3D%27font-size%3A+14.0%25%27%3Edynamic%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fextend%27+style%3D%27font-size%3A+14.0%25%27%3Eextend%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fgit%27+style%3D%27font-size%3A+18.0%25%27%3Egit%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fheadless%27+style%3D%27font-size%3A+12.0%25%27%3Eheadless%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finclude%27+style%3D%27font-size%3A+14.0%25%27%3Einclude%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Finstance-eval%27+style%3D%27font-size%3A+12.0%25%27%3Einstance_eval%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Flinux%27+style%3D%27font-size%3A+12.0%25%27%3Elinux%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogram%27+style%3D%27font-size%3A+12.0%25%27%3Emetaprogram%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fmetaprogramming%27+style%3D%27font-size%3A+18.0%25%27%3Emetaprogramming%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frevert%27+style%3D%27font-size%3A+12.0%25%27%3Erevert%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Frspec%27+style%3D%27font-size%3A+18.0%25%27%3Erspec%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fruby%27+style%3D%27font-size%3A+50.0%25%27%3Eruby%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fselenium-webdriver%27+style%3D%27font-size%3A+12.0%25%27%3Eselenium-webdriver%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fshell%27+style%3D%27font-size%3A+12.0%25%27%3Eshell%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fsubmodule%27+style%3D%27font-size%3A+12.0%25%27%3Esubmodule%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2FAndrew-Ken.github.com%2Fblog%2Fcategories%2Fxserver%27+style%3D%27font-size%3A+12.0%25%27%3Exserver%3C%2Fa%3E+%3C%2Ftags%3E">
	
</div></article>

<nav id="pagenavi">
    
        <a href="/blog/page/4/" class="prev">Prev</a>
    
    
        <a href="/blog/page/6/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Yank it - Just use it - 2013 <a
  href='http://www.linkedin.com/profile/view?id=122372553'>Ken Lu</a>, <a
      href="http://www.linkedin.com/profile/view?id=6957991">Andrew Paliyan</a>
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'guest';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-36461400-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>